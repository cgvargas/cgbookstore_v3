# 📄 CGBookStore v3 - Documento de Estado do Projeto

**Data:** 30/09/2025  
**Versão:** 3.1  
**Última Atualização:** Implementação de BookDetailView e Carrossel de Livros

---

## 🎯 Visão Geral do Projeto

**CGBookStore v3** é uma livraria online desenvolvida em Django 5.0.3 com PostgreSQL (Supabase), focada em proporcionar uma experiência completa de leitura com biblioteca pessoal gamificada e assistente literário inteligente.

### Tecnologias Principais
- **Backend:** Django 5.0.3
- **Banco de Dados Atual:** SQLite3 (desenvolvimento)
- **Banco de Dados Produção:** PostgreSQL 17.6 (Supabase) - **MIGRAÇÃO PENDENTE**
- **Python:** 3.13
- **Frontend:** Bootstrap 5, Font Awesome, Swiper.js
- **Controle de Versão:** Git + GitHub

---

## 📂 Estrutura Atual do Projeto

```
C:\ProjectsDjango\CGBookStore_v3\
├── cgbookstore/              # Configurações do projeto
│   ├── settings.py           # ✅ MEDIA configurado
│   ├── urls.py               # ✅ Static/Media configurado
│   └── wsgi.py
│
├── core/                     # App principal (livraria)
│   ├── models/               # ✅ MODULAR (NOVO)
│   │   ├── __init__.py
│   │   ├── category.py       # Model Category
│   │   ├── author.py         # Model Author
│   │   └── book.py           # Model Book + Google Books
│   ├── views/                # ✅ Modular
│   │   ├── __init__.py
│   │   ├── home_view.py
│   │   ├── book_views.py
│   │   ├── book_detail_view.py  # ✅ NOVO
│   │   ├── search_view.py
│   │   ├── about_view.py
│   │   ├── contact_view.py
│   │   └── library_view.py
│   ├── migrations/
│   │   ├── 0001_initial.py
│   │   ├── 0002_alter_book_options_author_created_at_and_more.py
│   │   └── 0003_alter_author_bio_alter_book_author_and_more.py
│   ├── admin.py              # ✅ Fieldsets organizados
│   ├── urls.py               # ✅ book_detail adicionado
│   └── utils/
│       └── supabase_storage.py
│
├── accounts/                 # App de autenticação
│   ├── forms.py
│   ├── views.py
│   ├── urls.py
│   └── admin.py
│
├── chatbot_literario/        # App do chatbot (placeholder)
│   ├── views.py
│   └── urls.py
│
├── templates/
│   ├── base.html             # ✅ Swiper integrado, Admin no dropdown
│   ├── core/
│   │   ├── home.html         # ✅ Carrossel implementado
│   │   ├── book_list.html    # ✅ Links de detalhes
│   │   ├── book_detail.html  # ✅ NOVO - Página completa
│   │   ├── search_results.html
│   │   ├── about.html
│   │   ├── contact.html
│   │   └── library.html      # Placeholder
│   └── accounts/
│       ├── login.html
│       └── register.html
│
├── static/
│   └── css/
│       └── carousel.css      # ✅ NOVO - Estilos do carrossel
│
├── media/                    # ✅ Configurado e funcionando
│   └── books/
│       └── covers/
│
├── documents/
│   └── status/
│       ├── status_29092025.md
│       └── status_30092025.md  # Este arquivo
│
├── .venv/                    # Ambiente virtual
├── .gitignore
├── requirements.txt
├── manage.py
├── db.sqlite3                # ⚠️ Banco atual (migrar para Supabase)
└── .env                      # Credenciais (não versionado)
```

---

## ✅ Funcionalidades Implementadas

### Core (Livraria)
- ✅ Página inicial com carrossel estilo Amazon/Kindle
- ✅ Catálogo de livros com paginação (12 por página)
- ✅ **BookDetailView completa com todos os campos**
- ✅ Sistema de busca (título, autor, categoria)
- ✅ Página "Sobre" institucional
- ✅ Formulário de contato (visual, preparado para email)
- ✅ Página de biblioteca pessoal (placeholder estruturado)
- ✅ Upload de imagens funcionando (MEDIA configurado)
- ✅ Navegação com breadcrumbs
- ✅ Livros relacionados por categoria
- ✅ Sistema de avaliação com estrelas (quando disponível)

### Autenticação
- ✅ Registro de usuários
- ✅ Login/Logout
- ✅ Proteção de rotas (biblioteca requer login)
- ✅ Navbar dinâmica (mostra usuário logado)
- ✅ Link Admin no dropdown para staff/superuser

### UI/UX
- ✅ Carrossel Swiper.js responsivo
- ✅ Efeitos hover nos cards
- ✅ Design profissional estilo e-commerce
- ✅ Navegação intuitiva
- ✅ Responsividade completa (mobile/tablet/desktop)

---

## 🗺️ Modelos de Dados

### **Category** (`core/models/category.py`)
```python
- name (CharField, unique)
- slug (SlugField, auto-gerado)
- featured (BooleanField)
- created_at (DateTimeField)
```

### **Author** (`core/models/author.py`)
```python
- name (CharField)
- slug (SlugField, auto-gerado)
- bio (TextField, nullable)
- created_at (DateTimeField)
```

### **Book** (`core/models/book.py`)
```python
# Campos locais
- title (CharField)
- slug (SlugField, auto-gerado)
- author (FK Author, nullable)
- category (FK Category, nullable)
- description (TextField, nullable)
- publication_date (DateField)
- isbn (CharField, unique, nullable)
- publisher (CharField, blank)
- price (DecimalField)
- cover_image (ImageField)

# Campos Google Books API (preparados)
- google_books_id (CharField, unique, nullable)
- subtitle (CharField, nullable)
- page_count (IntegerField, nullable)
- average_rating (DecimalField, nullable)
- ratings_count (IntegerField, nullable)
- preview_link (URLField, nullable)
- info_link (URLField, nullable)
- language (CharField, default='pt')

# Metadados
- created_at (DateTimeField)
- updated_at (DateTimeField)
```

---

## 🗺️ URLs Mapeadas

| URL | View | Nome | Autenticação |
|-----|------|------|--------------|
| `/` | HomeView | `core:home` | Não |
| `/livros/` | BookListView | `core:book_list` | Não |
| `/livros/<slug>/` | **BookDetailView** | `core:book_detail` | Não |
| `/buscar/` | SearchView | `core:search` | Não |
| `/sobre/` | AboutView | `core:about` | Não |
| `/contato/` | ContactView | `core:contact` | Não |
| `/biblioteca/` | LibraryView | `core:library` | **Sim** |
| `/contas/login/` | LoginView | `accounts:login` | Não |
| `/contas/registrar/` | RegisterView | `accounts:register` | Não |
| `/contas/logout/` | LogoutView | `accounts:logout` | Sim |
| `/chatbot/` | ChatbotView | `chatbot:chat` | Não |
| `/admin/` | Admin | `admin:index` | Sim (staff) |

---

## 🔧 Configurações Importantes

### Banco de Dados (settings.py)
```python
# ATUAL (SQLite3 - Desenvolvimento)
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}

# PRÓXIMO PASSO: Migrar para Supabase
# DATABASES = {
#     'default': dj_database_url.config(
#         default=config('DATABASE_URL'),
#         conn_max_age=600
#     )
# }
```

### Arquivos Estáticos e Media
```python
STATIC_URL = '/static/'
STATICFILES_DIRS = [os.path.join(BASE_DIR, 'static')]
STATIC_ROOT = os.path.join(BASE_DIR, 'staticfiles')

MEDIA_URL = '/media/'
MEDIA_ROOT = os.path.join(BASE_DIR, 'media')
```

### Supabase (Preparado, não usado ainda)
```python
SUPABASE_URL = config('SUPABASE_URL')
SUPABASE_ANON_KEY = config('SUPABASE_ANON_KEY')
```

---

## 📦 Dependências (requirements.txt)

```txt
Django==5.0.3
django-environ==0.11.2
python-decouple==3.8
psycopg[binary]>=3.1.0
dj-database-url==2.1.0
supabase>=2.4.0
storage3>=0.7.3
gotrue>=2.4.1
postgrest>=0.16.0
realtime>=2.0.0
supafunc>=0.4.0
Pillow>=10.0.0
```

---

## 🚧 Próximas Funcionalidades Planejadas

### 🔥 PRIORIDADE CRÍTICA - PRÓXIMO PASSO
1. **Migrar para PostgreSQL (Supabase)**
   - Configurar DATABASE_URL no .env
   - Testar conexão
   - Executar migrations no Supabase
   - Migrar dados existentes (se houver)
   - Atualizar settings.py

### Prioridade ALTA (Após Migração)
2. **Sistema de Seções e Prateleiras Dinâmicas**
   - Model Section (título, tipo, layout, ordem)
   - Model SectionItem (conteúdo da seção)
   - Model Video (para seções de vídeos)
   - Admin inline para gerenciar seções
   - Renderização dinâmica na home
   - Tipos: Livros, Autores, Vídeos
   - Layouts: Carrossel, Grid, Lista

3. **Popular Banco de Dados**
   - Adicionar 20-30 livros via Admin
   - Criar fixtures com dados iniciais
   - Usar script de importação

4. **Integração Google Books API**
   - Criar `core/utils/google_books_api.py`
   - Funções: search_books(), get_by_isbn(), import_to_catalog()
   - Interface admin para buscar e importar
   - Sincronização automática de dados

5. **Sistema de Biblioteca Pessoal (Backend)**
   - Models: UserProfile, BookShelf, ReadingProgress, BookReview
   - CRUD de prateleiras personalizadas
   - Progresso de leitura (%)
   - Sistema de avaliações privadas

### Prioridade MÉDIA
6. **Sistema de Carrinho de Compras**
   - Models: Cart, CartItem, Order
   - Checkout básico
   - Integração com pagamento (futuro)

7. **Filtros Avançados no Catálogo**
   - Filtro por categoria
   - Filtro por faixa de preço
   - Ordenação (preço, data, título, avaliação)
   - Busca avançada

8. **Sistema de Reviews Público**
   - Comentários públicos nos livros
   - Sistema de likes/dislikes
   - Moderação

### Prioridade BAIXA
9. **Chatbot Literário Funcional**
   - Integração com API (OpenAI/Ollama)
   - Recomendações personalizadas
   - Conversação sobre livros

10. **Gamificação**
    - Sistema de pontos por leitura
    - Conquistas (badges)
    - Ranking de leitores
    - Desafios de leitura

---

## 🔐 Variáveis de Ambiente (.env)

```env
# Django
SECRET_KEY=sua-secret-key-aqui
DEBUG=True
ALLOWED_HOSTS=localhost,127.0.0.1

# Supabase
SUPABASE_URL=https://xxxxx.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Database (CONFIGURAR PRÓXIMO)
DATABASE_URL=postgresql://postgres:[password]@db.[project].supabase.co:5432/postgres
```

---

## 🐛 Problemas Conhecidos

### Resolvidos
- ✅ Dependências incompatíveis (psycopg2-binary vs psycopg3)
- ✅ OneDrive causando conflitos com .git
- ✅ PyCharm não reconhecendo Django
- ✅ Estrutura de models não modular
- ✅ Imagens não aparecendo (MEDIA_URL não configurada)
- ✅ Link Admin não visível para superuser

### Pendentes
- ⚠️ Banco SQLite3 (migrar para Supabase PostgreSQL)
- ⚠️ Poucos livros cadastrados no banco
- ⚠️ Formulário de contato não envia email real
- ⚠️ Biblioteca não tem backend funcional (apenas visual)
- ⚠️ Seções da home são fixas (não gerenciáveis pelo admin)

---

## 🔄 Workflow Git

### Comando Diário
```powershell
# Início do dia (sincronizar)
git pull

# Fim do dia (enviar alterações)
git add .
git commit -m "Descrição das alterações"
git push
```

### Últimos Commits Importantes
```bash
✅ Feat: Implementa BookDetailView com suporte Google Books API
✅ Feat: Implementa carrossel de livros estilo Amazon na home
✅ Feat: Adiciona link do Admin no dropdown do usuário
```

### Repositório
- **GitHub:** https://github.com/cgvargas/cgbookstore_v3
- **Branch Principal:** main
- **Localização Local:** `C:\ProjectsDjango\CGBookStore_v3`

---

## 🚀 Como Executar o Projeto

### Primeira Vez
```powershell
# Clonar repositório
git clone https://github.com/cgvargas/cgbookstore_v3.git
cd cgbookstore_v3

# Criar ambiente virtual
python -m venv .venv
.\.venv\Scripts\activate

# Instalar dependências
pip install -r requirements.txt

# Configurar .env
Copy-Item .env.example .env
# Editar .env com credenciais reais

# Aplicar migrations
python manage.py migrate

# Criar superuser
python manage.py createsuperuser

# Rodar servidor
python manage.py runserver
```

### Uso Diário
```powershell
cd C:\ProjectsDjango\CGBookStore_v3
.\.venv\Scripts\activate
python manage.py runserver
```

---

## 📝 PRÓXIMO PASSO IMEDIATO

### 🔥 Migração para Supabase PostgreSQL

**Objetivo:** Substituir SQLite3 por PostgreSQL (Supabase) antes de acumular muitos dados.

**Passos:**
1. Configurar DATABASE_URL no .env com credenciais Supabase
2. Atualizar settings.py para usar dj_database_url
3. Testar conexão: `python manage.py dbshell`
4. Executar migrations: `python manage.py migrate`
5. Criar superuser no novo banco: `python manage.py createsuperuser`
6. (Opcional) Migrar dados do SQLite se houver dados importantes:
   ```powershell
   python manage.py dumpdata > backup.json
   # Configurar Supabase
   python manage.py loaddata backup.json
   ```
7. Testar aplicação completa
8. Commit: "Config: Migra banco de dados para Supabase PostgreSQL"

**Após migração, continuar com:**
- Sistema de Seções e Prateleiras Dinâmicas (Model Section, SectionItem, Video)
- Popular banco com mais livros
- Integração Google Books API

---

## 📚 Documentação Adicional

- **Django Docs:** https://docs.djangoproject.com/en/5.0/
- **Bootstrap 5:** https://getbootstrap.com/docs/5.3/
- **Supabase Docs:** https://supabase.com/docs
- **Swiper.js:** https://swiperjs.com/
- **Font Awesome:** https://fontawesome.com/icons
- **Google Books API:** https://developers.google.com/books

---

## 📊 Estatísticas do Projeto

- **Linhas de Código (estimado):** ~3.000
- **Models:** 3 (Category, Author, Book)
- **Views:** 7 (Home, BookList, BookDetail, Search, About, Contact, Library)
- **Templates:** 8 principais
- **Migrations:** 3 aplicadas
- **Commits Git:** 10+
- **Dias de Desenvolvimento:** 2

---

## 🎯 Visão de Longo Prazo

**CGBookStore v3** será uma plataforma completa que combina:
1. **E-commerce de Livros** (compra e venda)
2. **Biblioteca Pessoal Digital** (organização e tracking)
3. **Rede Social de Leitores** (reviews, recomendações)
4. **Assistente Literário IA** (chatbot inteligente)
5. **Gamificação** (conquistas, desafios, ranking)
6. **Integração Google Books** (catálogo massivo)
7. **Sistema de Vídeos** (entrevistas, book trailers, resenhas)

---

**Documento criado para continuidade do desenvolvimento.**  
**Última atualização:** 30/09/2025 23:45  
**Status:** Pronto para migração Supabase e implementação de Seções Dinâmicas