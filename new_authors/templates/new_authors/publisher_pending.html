{% extends 'new_authors/base.html' %}
{% load static %}

{% block title %}Aguardando Aprovação - {{ publisher.company_name }}{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Status Card -->
            <div class="card shadow-lg border-0">
                <div class="card-body p-5 text-center">
                    <!-- Ícone animado -->
                    <div class="mb-4">
                        <div class="spinner-border text-warning" role="status" style="width: 4rem; height: 4rem;">
                            <span class="visually-hidden">Carregando...</span>
                        </div>
                    </div>

                    <!-- Título -->
                    <h1 class="display-6 fw-bold mb-3">
                        <i class="bi bi-hourglass-split text-warning"></i>
                        Solicitação em Análise
                    </h1>

                    <!-- Mensagem Principal -->
                    <p class="lead text-muted mb-4">
                        Obrigado por se cadastrar, <strong>{{ publisher.company_name }}</strong>!
                    </p>

                    <div class="alert alert-info border-info">
                        <h5 class="alert-heading">
                            <i class="bi bi-info-circle"></i> Status da Solicitação
                        </h5>
                        <p class="mb-0">
                            Sua solicitação de cadastro foi recebida e está sendo analisada por nossa equipe.
                            Você receberá um email em <strong>{{ publisher.email }}</strong> assim que a
                            verificação for concluída.
                        </p>
                    </div>

                    <!-- Timeline do Processo -->
                    <div class="text-start mt-5 mb-4">
                        <h5 class="mb-4">
                            <i class="bi bi-list-check"></i> Processo de Verificação
                        </h5>

                        <div class="d-flex mb-3">
                            <div class="me-3">
                                <i class="bi bi-check-circle-fill text-success" style="font-size: 1.5rem;"></i>
                            </div>
                            <div>
                                <h6 class="mb-1">1. Solicitação Enviada</h6>
                                <p class="text-muted small mb-0">
                                    <i class="bi bi-calendar"></i> {{ publisher.created_at|date:"d/m/Y H:i" }}
                                </p>
                            </div>
                        </div>

                        <div class="d-flex mb-3">
                            <div class="me-3">
                                <div class="spinner-border spinner-border-sm text-warning" role="status">
                                    <span class="visually-hidden">Carregando...</span>
                                </div>
                            </div>
                            <div>
                                <h6 class="mb-1">2. Análise da Equipe</h6>
                                <p class="text-muted small mb-0">
                                    Verificando informações fornecidas (até 48h úteis)
                                </p>
                            </div>
                        </div>

                        <div class="d-flex mb-3">
                            <div class="me-3">
                                <i class="bi bi-circle text-secondary" style="font-size: 1.5rem;"></i>
                            </div>
                            <div>
                                <h6 class="mb-1 text-muted">3. Aprovação</h6>
                                <p class="text-muted small mb-0">
                                    Você receberá um email de confirmação
                                </p>
                            </div>
                        </div>

                        <div class="d-flex">
                            <div class="me-3">
                                <i class="bi bi-circle text-secondary" style="font-size: 1.5rem;"></i>
                            </div>
                            <div>
                                <h6 class="mb-1 text-muted">4. Acesso Liberado</h6>
                                <p class="text-muted small mb-0">
                                    Dashboard e informações de contato dos autores
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Informações Enviadas -->
                    <div class="card bg-light border-0 text-start mt-4">
                        <div class="card-header bg-light">
                            <h6 class="mb-0">
                                <i class="bi bi-file-earmark-text"></i> Informações Enviadas
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <small class="text-muted d-block">Nome da Editora:</small>
                                    <strong>{{ publisher.company_name }}</strong>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <small class="text-muted d-block">Email de Contato:</small>
                                    <strong>{{ publisher.email }}</strong>
                                </div>
                                {% if publisher.website %}
                                    <div class="col-md-6 mb-3">
                                        <small class="text-muted d-block">Website:</small>
                                        <a href="{{ publisher.website }}" target="_blank" class="text-decoration-none">
                                            {{ publisher.website }}
                                        </a>
                                    </div>
                                {% endif %}
                                {% if publisher.phone %}
                                    <div class="col-md-6 mb-3">
                                        <small class="text-muted d-block">Telefone:</small>
                                        <strong>{{ publisher.phone }}</strong>
                                    </div>
                                {% endif %}
                                <div class="col-12">
                                    <small class="text-muted d-block">Descrição:</small>
                                    <p class="mb-0">{{ publisher.description|truncatewords:50 }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Dúvidas -->
                    <div class="alert alert-light border mt-4">
                        <h6>
                            <i class="bi bi-question-circle"></i> Dúvidas?
                        </h6>
                        <p class="small mb-2">
                            Se você tiver alguma dúvida sobre o processo de verificação ou
                            precisar atualizar suas informações, entre em contato conosco:
                        </p>
                        <p class="small mb-0">
                            <i class="bi bi-envelope"></i>
                            <a href="mailto:suporte@cgbookstore.com">suporte@cgbookstore.com</a>
                        </p>
                    </div>

                    <!-- Botões -->
                    <div class="d-grid gap-2 mt-4">
                        <a href="{% url 'new_authors:books_list' %}" class="btn btn-primary btn-lg">
                            <i class="bi bi-book"></i> Explorar Livros Enquanto Aguarda
                        </a>
                        <button type="button" class="btn btn-outline-secondary" onclick="location.reload()">
                            <i class="bi bi-arrow-clockwise"></i> Atualizar Status
                        </button>
                    </div>
                </div>
            </div>

            <!-- FAQ -->
            <div class="card mt-4 border-0 shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-question-circle"></i> Perguntas Frequentes
                    </h5>
                </div>
                <div class="card-body">
                    <div class="accordion" id="faqAccordion">
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                    Quanto tempo demora a aprovação?
                                </button>
                            </h2>
                            <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Nossa equipe analisa todas as solicitações em até <strong>48 horas úteis</strong>.
                                    Em casos excepcionais, pode levar um pouco mais. Você receberá um email assim que
                                    a análise for concluída.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                    O que é verificado durante a análise?
                                </button>
                            </h2>
                            <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Verificamos a autenticidade da editora, informações de contato, histórico
                                    (quando disponível) e coerência das informações fornecidas. Editoras com
                                    website e presença online têm aprovação mais rápida.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                    E se minha solicitação for negada?
                                </button>
                            </h2>
                            <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Caso sua solicitação não seja aprovada, você receberá um email explicando
                                    os motivos. Você poderá fornecer informações adicionais e solicitar uma
                                    nova análise.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
                                    Posso atualizar minhas informações?
                                </button>
                            </h2>
                            <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                <div class="accordion-body">
                                    Durante o processo de análise, você pode solicitar atualizações enviando
                                    um email para <strong>suporte@cgbookstore.com</strong> com o assunto
                                    "Atualização de Cadastro - {{ publisher.company_name }}".
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Auto-refresh a cada 2 minutos para verificar se foi aprovado
setTimeout(function() {
    location.reload();
}, 120000); // 2 minutos
</script>
{% endblock %}
