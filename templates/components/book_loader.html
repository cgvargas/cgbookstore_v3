<!-- 
  Book Loading Animation Component - Premium Edition
  Livro animado com capa decorada que desfolia p√°ginas durante carregamento
  
  Uso: Inclua este componente onde precisar do loader
  {% include 'components/book_loader.html' %}
-->

<div class="book-loader-container" id="book-loader">
  <div class="book-loader">
    <div class="book">
      <!-- Capa frontal decorada -->
      <div class="book-cover">
        <div class="cover-decoration top"></div>
        <div class="cover-title">üìö</div>
        <div class="cover-subtitle">CGBookStore</div>
        <div class="cover-decoration bottom"></div>
      </div>
      <!-- P√°ginas animadas -->
      <div class="book-page"></div>
      <div class="book-page"></div>
      <div class="book-page"></div>
      <div class="book-page"></div>
      <div class="book-page"></div>
      <div class="book-page"></div>
    </div>
  </div>
  <p class="book-loader-text">Carregando<span class="loading-dots"><span>.</span><span>.</span><span>.</span></span></p>
</div>

<style>
  .book-loader-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    gap: 1.25rem;
  }

  .book-loader-text {
    color: var(--text-secondary, #555);
    font-size: 0.95rem;
    font-weight: 500;
    letter-spacing: 0.5px;
    display: flex;
    align-items: center;
    gap: 2px;
  }

  /* Dots animados */
  .loading-dots span {
    animation: dot-bounce 1.4s infinite ease-in-out;
    display: inline-block;
  }

  .loading-dots span:nth-child(1) {
    animation-delay: 0s;
  }

  .loading-dots span:nth-child(2) {
    animation-delay: 0.2s;
  }

  .loading-dots span:nth-child(3) {
    animation-delay: 0.4s;
  }

  @keyframes dot-bounce {

    0%,
    80%,
    100% {
      opacity: 0.3;
      transform: translateY(0);
    }

    40% {
      opacity: 1;
      transform: translateY(-3px);
    }
  }

  .book-loader {
    --book-primary: #8B2323;
    --book-secondary: #6B1818;
    --book-dark: #4A1010;
    --gold-accent: #D4AF37;
    --gold-light: #F4D03F;
    --page-color: #FFFEF5;
    --page-aged: #F5F0E0;
    --page-shadow: rgba(0, 0, 0, 0.12);
    perspective: 800px;
    filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.25));
  }

  .book {
    width: 75px;
    height: 100px;
    position: relative;
    transform-style: preserve-3d;
    transform: rotateY(-30deg) rotateX(5deg);
    animation: book-float 3s ease-in-out infinite;
  }

  @keyframes book-float {

    0%,
    100% {
      transform: rotateY(-30deg) rotateX(5deg) translateY(0);
    }

    50% {
      transform: rotateY(-30deg) rotateX(5deg) translateY(-5px);
    }
  }

  /* Lombada do livro com detalhes dourados */
  .book::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    width: 12px;
    height: 100%;
    background: linear-gradient(to right,
        var(--book-dark),
        var(--book-secondary) 30%,
        var(--book-primary) 50%,
        var(--book-secondary) 70%,
        var(--book-dark));
    transform: rotateY(90deg) translateZ(6px);
    border-radius: 3px 0 0 3px;
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3);
  }

  /* Detalhes dourados na lombada */
  .book::after {
    content: '';
    position: absolute;
    left: -6px;
    top: 5%;
    width: 12px;
    height: 90%;
    background: repeating-linear-gradient(to bottom,
        transparent 0px,
        transparent 8px,
        var(--gold-accent) 8px,
        var(--gold-accent) 10px,
        transparent 10px,
        transparent 18px);
    transform: rotateY(90deg) translateZ(6px);
    opacity: 0.7;
    pointer-events: none;
    z-index: 10;
  }

  /* Capa frontal decorada */
  .book-cover {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(145deg,
        var(--book-primary) 0%,
        var(--book-secondary) 50%,
        var(--book-dark) 100%);
    transform: translateZ(4px);
    border-radius: 0 4px 4px 0;
    box-shadow:
      2px 2px 8px rgba(0, 0, 0, 0.4),
      inset 0 0 20px rgba(0, 0, 0, 0.2);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    z-index: 10;
  }

  /* Decora√ß√µes douradas */
  .cover-decoration {
    position: absolute;
    left: 10%;
    right: 10%;
    height: 2px;
    background: linear-gradient(90deg,
        transparent,
        var(--gold-accent) 20%,
        var(--gold-light) 50%,
        var(--gold-accent) 80%,
        transparent);
    box-shadow: 0 0 4px var(--gold-accent);
  }

  .cover-decoration.top {
    top: 12%;
  }

  .cover-decoration.bottom {
    bottom: 12%;
  }

  .cover-title {
    font-size: 1.5rem;
    margin-bottom: 2px;
    filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.4));
    animation: glow-pulse 2s infinite;
  }

  @keyframes glow-pulse {

    0%,
    100% {
      filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.4));
    }

    50% {
      filter: drop-shadow(0 2px 8px rgba(212, 175, 55, 0.6));
    }
  }

  .cover-subtitle {
    font-size: 0.45rem;
    font-weight: 700;
    letter-spacing: 1px;
    color: var(--gold-accent);
    text-transform: uppercase;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
  }

  /* Capa traseira */
  .book>.book-page:last-child::after {
    content: '';
    position: absolute;
    left: -5px;
    top: -3px;
    width: calc(100% + 8px);
    height: calc(100% + 6px);
    background: linear-gradient(135deg, var(--book-secondary) 0%, var(--book-dark) 100%);
    transform: translateZ(-8px);
    border-radius: 0 3px 3px 0;
    box-shadow: 3px 3px 12px rgba(0, 0, 0, 0.4);
    z-index: -1;
  }

  .book-page {
    position: absolute;
    left: 8px;
    top: 4px;
    width: calc(100% - 12px);
    height: calc(100% - 8px);
    background: linear-gradient(to right, var(--page-aged), var(--page-color));
    border-radius: 0 3px 3px 0;
    transform-origin: left center;
    box-shadow: 1px 0 3px var(--page-shadow);
    animation: flip-page 3.5s ease-in-out infinite;
  }

  /* Detalhes nas p√°ginas - linhas de texto */
  .book-page::before {
    content: '';
    position: absolute;
    top: 12%;
    left: 12%;
    right: 15%;
    height: 65%;
    background: repeating-linear-gradient(to bottom,
        transparent,
        transparent 5px,
        rgba(0, 0, 0, 0.08) 5px,
        rgba(0, 0, 0, 0.08) 6px);
    opacity: 0.6;
  }

  /* Marca d'√°gua sutil na p√°gina */
  .book-page::after {
    content: 'üìñ';
    position: absolute;
    bottom: 8%;
    right: 10%;
    font-size: 0.6rem;
    opacity: 0.15;
  }

  /* Anima√ß√£o das p√°ginas em sequ√™ncia com timing melhorado */
  .book-page:nth-child(2) {
    animation-delay: 0s;
    z-index: 6;
  }

  .book-page:nth-child(3) {
    animation-delay: 0.5s;
    z-index: 5;
  }

  .book-page:nth-child(4) {
    animation-delay: 1s;
    z-index: 4;
  }

  .book-page:nth-child(5) {
    animation-delay: 1.5s;
    z-index: 3;
  }

  .book-page:nth-child(6) {
    animation-delay: 2s;
    z-index: 2;
  }

  .book-page:nth-child(7) {
    animation-delay: 2.5s;
    z-index: 1;
  }

  @keyframes flip-page {

    0%,
    10% {
      transform: rotateY(0deg);
      background: linear-gradient(to right, var(--page-aged), var(--page-color));
      box-shadow: 1px 0 3px var(--page-shadow);
    }

    20% {
      transform: rotateY(-60deg);
      background: linear-gradient(to left, var(--page-color), #e8e8d8);
      box-shadow: 8px 0 15px rgba(0, 0, 0, 0.2);
    }

    30% {
      transform: rotateY(-120deg);
      background: linear-gradient(to left, #e8e8d8, var(--page-aged));
      box-shadow: 3px 0 8px rgba(0, 0, 0, 0.15);
    }

    40%,
    100% {
      transform: rotateY(-180deg);
      background: var(--page-aged);
      box-shadow: -1px 0 3px var(--page-shadow);
    }
  }

  /* ============ VARIA√á√ÉO TEMA ESCURO ============ */
  [data-theme="dark"] .book-loader,
  .dark .book-loader {
    --book-primary: #5A1515;
    --book-secondary: #3A0F0F;
    --book-dark: #2A0808;
    --page-color: #E8E4D8;
    --page-aged: #D8D4C8;
    filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.5));
  }

  [data-theme="dark"] .book-loader-text,
  .dark .book-loader-text {
    color: #bbb;
  }

  /* ============ VERS√ÉO PEQUENA ============ */
  .book-loader-container.small {
    padding: 1rem;
    gap: 0.75rem;
  }

  .book-loader-container.small .book {
    width: 50px;
    height: 68px;
  }

  .book-loader-container.small .book::before {
    width: 8px;
  }

  .book-loader-container.small .cover-title {
    font-size: 1rem;
  }

  .book-loader-container.small .cover-subtitle {
    font-size: 0.35rem;
  }

  .book-loader-container.small .book-loader-text {
    font-size: 0.8rem;
  }

  /* ============ VERS√ÉO FULLSCREEN ============ */
  .book-loader-container.fullscreen {
    position: fixed;
    inset: 0;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(5px);
    z-index: 9999;
  }

  [data-theme="dark"] .book-loader-container.fullscreen,
  .dark .book-loader-container.fullscreen {
    background: rgba(20, 20, 25, 0.95);
  }

  .book-loader-container.fullscreen .book {
    width: 100px;
    height: 135px;
  }

  .book-loader-container.fullscreen .book::before {
    width: 15px;
  }

  .book-loader-container.fullscreen .cover-title {
    font-size: 2rem;
  }

  .book-loader-container.fullscreen .cover-subtitle {
    font-size: 0.55rem;
    letter-spacing: 1.5px;
  }

  .book-loader-container.fullscreen .book-loader-text {
    font-size: 1.1rem;
  }

  /* ============ ESCONDER ============ */
  .book-loader-container.hidden {
    display: none;
  }
</style>

<script>
  // Fun√ß√µes para controlar o loader
  window.BookLoader = {
    show: function (containerId, fullscreen) {
      const loader = document.getElementById(containerId || 'book-loader');
      if (loader) {
        loader.classList.remove('hidden');
        if (fullscreen) loader.classList.add('fullscreen');
      }
    },
    hide: function (containerId) {
      const loader = document.getElementById(containerId || 'book-loader');
      if (loader) {
        loader.classList.add('hidden');
        loader.classList.remove('fullscreen');
      }
    },
    setText: function (text, containerId) {
      const loader = document.getElementById(containerId || 'book-loader');
      if (loader) {
        const textEl = loader.querySelector('.book-loader-text');
        if (textEl) {
          // Mant√©m os dots animados
          textEl.innerHTML = text + '<span class="loading-dots"><span>.</span><span>.</span><span>.</span></span>';
        }
      }
    },
    setSize: function (size, containerId) {
      const loader = document.getElementById(containerId || 'book-loader');
      if (loader) {
        loader.classList.remove('small', 'fullscreen');
        if (size === 'small' || size === 'fullscreen') {
          loader.classList.add(size);
        }
      }
    }
  };
</script>